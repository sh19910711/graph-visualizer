language: ruby
branches:
  only:
    - master
    - develop
    - /^exercise-.*$/
    - /^feature\/.*$/
    - heroku/development
rvm:
  - 2.1.0
before_script:
  - bundle install
  - npm install
script:
  - bundle exec rake test
  - npm run-script test
  - bundle exec rake doc
  - npm run-script doc
after_script:
  - 
    if [ "${TRAVIS_BRANCH}" == "develop" ]; then
      git clone --quiet --single-branch -b gh-pages git://github.com/sh19910711/web-graph-visualizer.git tmp/gh-pages ;
      cp -r doc tmp/gh-pages/ ;
      cd tmp/gh-pages/ ;
      git config --global user.email "sh19910711+ynkkowrv0b14@gmail.com" ;
      git config --global user.name "Mr. Bot" ;
      git add doc &&
        git commit -m 'Update Document' &&
        git push --quiet https://${GITHUB_TOKEN}@github.com/sh19910711/web-graph-visualizer.git gh-pages ;
    fi
env:
  global:
    - secure: "E7jPQ/LyZFl8l3/Zg3CPCrMM6WcAUFE7mfOObP36xLfTmkZWMA+QOFjxZsvgcHNEbaJdlsCRqN9vsSkobbt07G4YGbXOHojI/O8XA9oCfaGsKfiMt08l/kOsuJyQRe/fsn4MmfpxnQbPLs4zMtZxpqI6KR+fvYx3WIpvkl5mMyo="
gemfile:
  - Gemfile
notifications:
  webhooks:
    urls:
      - https://webhooks.gitter.im/e/ecc9c266d5c4e7d4d2b7
    on_success: change
    on_failure: always
    on_start: false
deploy:
  provider: heroku
  api_key:
    secure: "h4UaaDKAkZrI4B3zoBB/oBiHGlMHsi7EKv74QpCJku/yvULdKFtHnjY13P6C3giIPGfMNLx58eZkkmiOM0wzfSIVRujXq4JyxqYa0x0MhByFjt/cLBUOKgSRcOZK8jH9BRhDG8Tkn6vD8nqQzvZoF8c7b1X3pEZNiSv+9DYaesk="
  app:
    heroku/development: graph-visualizer-xkb

